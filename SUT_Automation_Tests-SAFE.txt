*** Settings ***
Library           Selenium2Library
Library           AutoItLibrary
Library           OperatingSystem
Library           C:/Users/Jeffrey.Thomas/Results/Data/matchingNameFour.py
Library           Process
Library           String
Variables         C:/Python27/Lib/site-packages/varfile.py

*** Variables ***
${updateResultsFolder}    T:/WIL/Departments/TaxContentQA/Test Artifacts & Results/SUT Content Update
${taxtestPartialPath}    PlSql/Update/
${updateGenerateFolder}    T:/WIL/Apps/scms_data/GenerateOutput
${controlGenerateFolder}    T:/WIL/Compliance/X/Tdg/updates/small files
${dataExtractionFolder}    //devsrv005/L/Content_Data_Extraction
${SUTAutomationFolder}    T:/WIL/Departments/TaxContentQA/Test Artifacts & Results/Special_Projects/SUT Automation

*** Test Cases ***
Unzip
    [Tags]    getJenkinsMasterFiles
    Given user is logged in
    When welcome page is open
    Then user saves the files
    Then user returns to command prompt

Extract
    [Tags]    getJenkinsMasterFiles
    OperatingSystem.Run    C:/Users/Jeffrey.Thomas/Results/Data/Extract_Master_Files-local.py

Move Master Control Files to ContentQA
    Move files    ${currentYear}-${currentNoMonth}-sut-cobol-${buildTypePartialPath}-full/MainFiles/*    ${dataExtractionFolder}/Cobol/${agePartialPath}/Master/
    Copy file    ${currentYear}-${currentNoMonth}-sut-c-${buildTypePartialPath}-full/MainFiles/zipseq    ${dataExtractionFolder}/PLSQL/${agePartialPath}/Master/zipseq.dat
    Move files    ${currentYear}-${currentNoMonth}-sut-c-${buildTypePartialPath}-full/MainFiles/*    ${dataExtractionFolder}/C/${agePartialPath}/Master/
    Move files    ${currentYear}-${currentNoMonth}-sut-plsql-${buildTypePartialPath}-full/MainFiles/*    ${dataExtractionFolder}/PLSQL/${agePartialPath}/Master/
    Move files    ${currentYear}-${currentNoMonth}-sut-cobol-${buildTypePartialPath}-full/ControlFiles/*    ${dataExtractionFolder}/Cobol/${agePartialPath}/Control/
    Move files    ${currentYear}-${currentNoMonth}-sut-c-${buildTypePartialPath}-full/ControlFiles/*    ${dataExtractionFolder}/C/${agePartialPath}/Control/
    Move files    ${currentYear}-${currentNoMonth}-sut-plsql-${buildTypePartialPath}-full/ControlFiles/*    ${dataExtractionFolder}/PLSQL/${agePartialPath}/Control/

Copy Update Control Files to ContentQA
    Run    C:/Users/Jeffrey.Thomas/Results/Data/matchingNameFour.py
    printResultsToFile    \    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/
    @{FILES}=    getMatchingName    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/file.txt    \    LoadFiles
    : FOR    ${FILE}    IN    @{FILES}
    \    Run Keyword If    '${FILE}'=='caltrtpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/caltrtpd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='canprovs'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/canprovs    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='feedescs'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/feedescs    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='feeexten'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/feeexten    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='nexdesc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/nexdesc    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='nexdesc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/nexdesc    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='nexdesc'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/nexdesc    ${templateFolder}/Files/Update/Control/PLSQL/nexdesc.dat
    \    Run Keyword If    '${FILE}'=='PILoad.dat'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/PILoad.dat    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='prdistpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/prdistpd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='proddesc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/proddesc    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='proddesc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/proddesc    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='proddesc'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/proddesc    ${templateFolder}/Files/Update/Control/PLSQL/proddesc.dat
    \    Run Keyword If    '${FILE}'=='prodext'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/prodext    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='stepcnty.dat'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepcnty    ${templateFolder}/Files/Update/Control/PLSQL/stepcnty.dat
    \    Run Keyword If    '${FILE}'=='stepreas'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepreas    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='stepreas'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepreas    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='stepreas'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepreas    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='stepreas'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/stepreas    ${templateFolder}/Files/Update/Control/PLSQL/stepreas.dat
    \    Run Keyword If    '${FILE}'=='stepstcd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstcd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='stepstcd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstcd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='stepstcd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstcd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='stepstcd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/stepstcd    ${templateFolder}/Files/Update/Control/PLSQL/stepstcd.dat
    \    Run Keyword If    '${FILE}'=='stepstcn'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstcn    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='stepstcn'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstcn    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='stepstcn'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstcn    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='stepstcn'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/stepstcn    ${templateFolder}/Files/Update/Control/PLSQL/stepstcn.dat
    \    Run Keyword If    '${FILE}'=='stepstrc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstrc    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='stepstrc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstrc    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='stepstrc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstrc    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='stepstrc'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/stepstrc    ${templateFolder}/Files/Update/Control/PLSQL/stepstrc.dat
    \    Run Keyword If    '${FILE}'=='stepstre'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstre    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='stepstre'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstre    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='stepstre'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/stepstre    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='stepstre'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/stepstre    ${templateFolder}/Files/Update/Control/PLSQL/stepstre.dat
    \    Run Keyword If    '${FILE}'=='taxbkt'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxbkt    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxbkt'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxbkt    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxbyitm'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxbyitm    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxbyitm'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxbyitm    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxbyitm'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxbyitm    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxbyitm'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxbyitm    ${templateFolder}/Files/Update/Control/PLSQL/taxbyitm.dat
    \    Run Keyword If    '${FILE}'=='taxcuspd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxcuspd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxcuspd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxcuspd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxcuspd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxcuspd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxcuspd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxcuspd    ${templateFolder}/Files/Update/Control/PLSQL/taxcuspd.dat
    \    Run Keyword If    '${FILE}'=='taxdivpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxdivpd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxdivpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxdivpd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxdivpd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxdivpd    ${templateFolder}/Files/Update/Control/PLSQL/taxdivpd.dat
    \    Run Keyword If    '${FILE}'=='taxdlvr'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxdlvr    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxdscpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxdscpd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxdscpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxdscpd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxdscpd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxdscpd    ${templateFolder}/Files/Update/Control/PLSQL/taxdscpd.dat
    \    Run Keyword If    '${FILE}'=='taxexc34'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxexc34    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxexczp'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxexczp    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxexczp'    Copy file    ${controlGeateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxexczp    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxexczp'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxexczp    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxexczp'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxexczp    ${templateFolder}/Files/Update/Control/PLSQL/taxexczp.dat
    \    Run Keyword If    '${FILE}'=='taxexmax'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxexmax    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxfees'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxfees    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxfrtpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxfrtpd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxfrtpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxfrtpd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxfrtpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxfrtpd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxfrtpd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxfrtpd    ${templateFolder}/Files/Update/Control/PLSQL/taxfrtpd.dat
    \    Run Keyword If    '${FILE}'=='taxholdy'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxholdy    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxholdy'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxholdy    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxholdy'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxholdy    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxholdy'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxholdy    ${templateFolder}/Files/Update/Control/PLSQL/taxholdy.dat
    \    Run Keyword If    '${FILE}'=='taxholdy2'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxholdy2    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxholdy2'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxholdy2    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxholdy2'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxholdy2    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxholdy2'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxholdy2    ${templateFolder}/Files/Update/Control/PLSQL/taxholdy2.dat
    \    Run Keyword If    '${FILE}'=='taxjurcd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxjurcd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxjurcd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxjurcd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxjurcd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxjurcd    ${templateFolder}/Files/Update/Control/PLSQL/taxjurcd.dat
    \    Run Keyword If    '${FILE}'=='taxjurpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxjurpd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxjurpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxjurpd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxjurpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxjurpd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxjurpd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxjurpd    ${templateFolder}/Files/Update/Control/PLSQL/taxjurpd.dat
    \    Run Keyword If    '${FILE}'=='taxjurpr'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxjurpr    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxmappd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxmappd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxmxtax.dat'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxmxdat.dat    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxprizp'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxprizp    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxprizp'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxprizp    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxprizp'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxprizp    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxprizp'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxprizp    ${templateFolder}/Files/Update/Control/PLSQL/taxprizp.dat
    \    Run Keyword If    '${FILE}'=='taxrfnds'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxrfnds    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxrnd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxrnd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxrnd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxrnd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxrntpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxrntpd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxrntpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxrntpd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxrntpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxrntpd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxrntpd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxrntpd    ${templateFolder}/Files/Update/Control/PLSQL/taxrntpd.dat
    \    Run Keyword If    '${FILE}'=='taxsrcpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxsrcpd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxsrcpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxsrcpd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxsrcpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxsrcpd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxsrcpd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxsrcpd    ${templateFolder}/Files/Update/Control/PLSQL/taxsrcpd.dat
    \    Run Keyword If    '${FILE}'=='taxstapd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxstapd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='taxstapd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxstapd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxstapd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxstapd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxstapd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxstapd    ${templateFolder}/Files/Update/Control/PLSQL/taxstapd.dat
    \    Run Keyword If    '${FILE}'=='taxstuez'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxstuez    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxvalzp'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxvalzp    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='taxvalzp'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/taxvalzp    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='taxvalzp'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/taxvalzp    ${templateFolder}/Files/Update/Control/PLSQL/taxvalzp.dat
    \    Run Keyword If    '${FILE}'=='texasexc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/texasexc    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='texasexc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/texasexc    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='texasexc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/texasexc    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='texasexc'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/texasexc    ${templateFolder}/Files/Update/Control/PLSQL/texasexc.dat
    \    Run Keyword If    '${FILE}'=='txbackex'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txbackex    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='txcanada.dat'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txcanada.dat    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='txlocadm'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txlocadm    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='txlocadm'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txlocadm    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='txlocadm'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/txlocadm    ${templateFolder}/Files/Update/Control/PLSQL/txlocadm.dat
    \    Run Keyword If    '${FILE}'=='txnexadm'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txnexadm    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='txnexadm'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txnexadm    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='txnexadm'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/txnexadm    ${templateFolder}/Files/Update/Control/PLSQL/txnexadm.dat
    \    Run Keyword If    '${FILE}'=='txnobkst'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txnobkst    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='txrndexc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txrndexc    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='txrndexc'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txrndexc    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='txspdpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txspdpd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='txspdpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txspdpd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='txspdpd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/txspdpd    ${templateFolder}/Files/Update/Control/PLSQL/
    \    Run Keyword If    '${FILE}'=='txspdpd'    Move file    ${templateFolder}/Files/Update/Control/PLSQL/txspdpd    ${templateFolder}/Files/Update/Control/PLSQL/txspdpd.dat
    \    Run Keyword If    '${FILE}'=='zipstapd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/zipstapd    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='zipstapd'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/zipstapd    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='zipvalzp'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/zipvalzp    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='zpexs34'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/zpexs34    ${templateFolder}/Files/Update/Control/C/
    \    Run Keyword If    '${FILE}'=='zpexseq'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/zpexseq    ${templateFolder}/Files/Update/Control/Cobol/
    \    Run Keyword If    '${FILE}'=='zpexseq'    Copy file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/zpexseq    ${templateFolder}/Files/Update/Control/C/
    \    Log    ${FILE}    console=yes

Copy Files to Systems
    Copy file    ${dataExtractionFolder}/PLSQL/${agePartialPath}/Master/excprule.dat    ${PLSQLInfo}/excprule
    Copy file    ${dataExtractionFolder}/PLSQL/${agePartialPath}/Master/newmast.dat    ${PLSQLInfo}/newmast
    Copy file    ${dataExtractionFolder}/PLSQL/${agePartialPath}/Master/prodseq.dat    ${PLSQLInfo}/prodseq
    Copy file    ${dataExtractionFolder}/PLSQL/${agePartialPath}/Master/zipseq.dat    ${PLSQLInfo}/zipseq
    Copy files    ${dataExtractionFolder}/C/${agePartialPath}/Master/cntyseq    ${dataExtractionFolder}/C/${agePartialPath}/Master/excprule    ${dataExtractionFolder}/C/${agePartialPath}/Master/feedata    ${dataExtractionFolder}/C/${agePartialPath}/Master/newmast    ${dataExtractionFolder}/C/${agePartialPath}/Master/prodseq    ${dataExtractionFolder}/C/${agePartialPath}/Master/zipseq
    ...    ${CInfo}/indata/
    Copy files    ${dataExtractionFolder}/Cobol/${agePartialPath}/Master/cntyseq    ${dataExtractionFolder}/Cobol/${agePartialPath}/Master/newmast    ${dataExtractionFolder}/Cobol/${agePartialPath}/Master/prodseq    ${dataExtractionFolder}/Cobol/${agePartialPath}/Master/zipseq    ${dataExtractionFolder}/Cobol/${agePartialPath}/Master/excprule    ${CobolInfo}/
    Copy files    ${dataExtractionFolder}/PLSQL/${agePartialPath}/Control/*    ${currentPLSQLFolder}/sales_use/LOAD_SCRIPTS/
    Copy files    ${dataExtractionFolder}/C/${agePartialPath}/Control/*    ${CInfo}/indata/
    Copy files    ${dataExtractionFolder}/Cobol/${agePartialPath}/Control/*    ${CobolInfo}/
    Run Keyword If    '${Status}'=='Update'    Copy files    ${templateFolder}/Files/Update/Control/PLSQL/*    ${currentPLSQLFolder}/sales_use/LOAD_SCRIPTS/
    Run Keyword If    '${Status}'=='Update'    Copy files    ${templateFolder}/Files/Update/Control/C/*    ${CInfo}/indata/
    Run Keyword If    '${Status}'=='Update'    Copy files    ${templateFolder}/Files/Update/Control/Cobol/*    ${CobolInfo}/
    Run Keyword If    '${Status}'=='Update'    Copy file    ${updateGenerateFolder}/${updateGenerateVersionFolder}/${updateGenerateTypeFolder}/${currentMonthYear_updateGenerate}/Standard/UPDATE/taxupdt*    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/ud001
    Run Keyword If    '${Status}'=='Update'    Copy file    ${updateGenerateFolder}/${updateGenerateVersionFolder}/${updateGenerateTypeFolder}/${currentMonthYear_updateGenerate}/Standard/UPDATE/zipupdt*    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/ud002
    Run Keyword If    '${Status}'=='Update'    Copy file    ${updateGenerateFolder}/${updateGenerateVersionFolder}/${updateGenerateTypeFolder}/${currentMonthYear_updateGenerate}/Standard/UPDATE/produpdt*    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/ud003
    Run Keyword If    '${Status}'=='Update'    Copy files    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/*    ${PLSQLInfo}/
    Log    ${Status}    console=yes

Master Control Load PLSQL
    Run Keyword If    '${Status}'=='Update'    Run    C:/Users/Jeffrey.Thomas/Results/Data/Load_Control_Files_PLSQL.bat
    Run    C:/Users/Jeffrey.Thomas/Results/Data/Load_Master_PLSQL_One.bat
    Move files    ${PLSQLInfo}/newmast.log    ${PLSQLInfo}/prodseq.log    ${PLSQLInfo}/excprule.log    ${PLSQLInfo}/zipseq.log    ${templateFolder}/PLSQL/Update/${updateTypePartialPath}/
    Move files    ${PLSQLInfo}/ud001.log    ${PLSQLInfo}/ud001.rpts    ${PLSQLInfo}/ud002.log    ${PLSQLInfo}/ud002.rpts    ${PLSQLInfo}/ud003.log    ${PLSQLInfo}/ud003.rpts    ${templateFolder}/PLSQL/Update/${updateTypePartialPath}/

Master Control Load C
    Run    C:/Users/Jeffrey.Thomas/Results/Data/Load_Master_C.py
    Run    C:/Users/Jeffrey.Thomas/Results/Data/matchingNameFour.py
    printResultsToFile    \    ${templateFolder}/Files/Update/Control/C/
    @{FILES}=    getMatchingName    ${templateFolder}/Files/Update/Control/C/file.txt    \    LoadFiles
    : FOR    ${FILE}    IN    @{FILES}
    \    Run Keyword If    '${FILE}'=='stepstrc'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_Step_Files_C.py
    \    Log    ${FILE}    console=yes
    Move files    ${CInfo}/toolkit/tax007.out    ${CInfo}/toolkit/tax020.out    ${CInfo}/toolkit/zip040.out    ${templateFolder}/C/Update/${updateTypePartialPath}/

Master Control Load Cobol
    Move file    ${CobolInfo}/AVPTRANS-LOAD    ${CobolInfo}/AVPTRANS
    Run    C:/Users/Jeffrey.Thomas/Results/Data/Load_Master_Cobol.bat
    Move file    ${CobolInfo}/AVPTRANS    ${CobolInfo}/AVPTRANS-LOAD
    Move files    ${CobolInfo}/RPT007    ${CobolInfo}/RPT021    ${CobolInfo}/RPTEXC    ${templateFolder}/Cobol/Update/${updateTypePartialPath}/

Update Control Load
    Run    C:/Users/Jeffrey.Thomas/Results/Data/matchingNameFour.py
    printResultsToFile    \    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/
    @{FILES}=    getMatchingName    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/file.txt    \    LoadFiles
    : FOR    ${FILE}    IN    @{FILES}
    \    Run Keyword If    '${FILE}'=='excprule'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_${FILE}_PLSQL_One.bat
    @{FILES}=    getMatchingName    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/file.txt    \    updateFiles_PLSQL
    : FOR    ${FILE}    IN    @{FILES}
    \    Run Keyword If    '${FILE}'=='ud001'    Run    C:/Users/Jeffrey.Thomas/Results/Data/Load_Update_PLSQL_ud001_One.bat
    \    Run Keyword If    '${FILE}'=='ud002'    Run    C:/Users/Jeffrey.Thomas/Results/Data/Load_Update_PLSQL_ud002_One.bat
    \    Run Keyword If    '${FILE}'=='ud003'    Run    C:/Users/Jeffrey.Thomas/Results/Data/Load_Update_PLSQL_ud003_One.bat
    Run keyword and ignore error    Move file    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/ud001    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/taxupdt_xxx
    Run keyword and ignore error    Move file    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/ud002    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/zipupdt_xxx
    Run keyword and ignore error    Move file    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/ud003    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/produpdt_xxx
    Copy files    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/*    ${CInfo}/indata/
    Run    C:/Users/Jeffrey.Thomas/Results/Data/matchingNameFour.py
    @{FILES}=    getMatchingName    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/file.txt    \    LoadFiles
    : FOR    ${FILE}    IN    @{FILES}
    \    Run Keyword If    '${FILE}'=='cntyseq'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_${FILE}_C.py
    \    Run Keyword If    '${FILE}'=='feedata'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_${FILE}_C.py
    \    Run Keyword If    '${FILE}'=='excprule'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_${FILE}_C.py
    @{FILES}=    getMatchingName    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/file.txt    \    updateFiles_PLSQL
    : FOR    ${FILE}    IN    @{FILES}
    \    Log    ${FILE}    console=yes
    \    Run Keyword If    '${FILE}'=='ud001'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_taxupdt_xxx_C.py
    \    Run Keyword If    '${FILE}'=='ud002'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_zipupdt_xxx_C.py
    \    Run Keyword If    '${FILE}'=='ud003'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_produpdt_xxx_C.py
    Run keyword and ignore error    Move file    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/taxupdt_xxx    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/avptrans
    Run keyword and ignore error    Move file    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/zipupdt_xxx    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/zipupdt
    Run keyword and ignore error    Move file    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/produpdt_xxx    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/produpdt
    Copy files    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/*    ${CobolInfo}/
    Run    C:/Users/Jeffrey.Thomas/Results/Data/matchingNameFour.py
    @{FILES}=    getMatchingName    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/file.txt    \    LoadFiles
    : FOR    ${FILE}    IN    @{FILES}
    \    Run Keyword If    '${FILE}'=='cntyseq'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_${FILE}_Cobol.py
    \    Run Keyword If    '${FILE}'=='excprule'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_${FILE}_Cobol.py
    @{FILES}=    getMatchingName    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/file.txt    \    updateFiles_PLSQL
    : FOR    ${FILE}    IN    @{FILES}
    \    Log    ${FILE}    console=yes
    \    Run Keyword If    '${FILE}'=='ud001'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_taxupdt_Cobol.py
    \    Run Keyword If    '${FILE}'=='ud002'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_zipupdt_Cobol.py
    \    Run Keyword If    '${FILE}'=='ud003'    Run    C:/Users/Jeffrey.Thomas/Results/Data/load_produpdt_Cobol.py

Cleanup Local
    Remove file    C:/Users/jeffrey.thomas/Downloads/${currentYear}-${currentNoMonth}-sut-cobol-regular-full.zip
    Remove file    C:/Users/jeffrey.thomas/Downloads/${currentYear}-${currentNoMonth}-sut-c-regular-full.zip
    Remove file    C:/Users/jeffrey.thomas/Downloads/${currentYear}-${currentNoMonth}-sut-plsql-regular-full.zip
    Remove Directory    C:/Users/jeffrey.thomas/${currentYear}-${currentNoMonth}-sut-cobol-regular-full/    true
    Remove Directory    C:/Users/jeffrey.thomas/${currentYear}-${currentNoMonth}-sut-c-regular-full/    true
    Remove Directory    C:/Users/jeffrey.thomas/${currentYear}-${currentNoMonth}-sut-plsql-regular-full/    true

Cleanup Remote
    Copy Directory    ${templateFolder}    ${SUTAutomationFolder}/Template_Backup
    Remove files    ${templateFolder}/Files/Update/Control/PLSQL/*
    Remove files    ${templateFolder}/Files/Update/Control/C/*
    Remove files    ${templateFolder}/Files/Update/Control/Cobol/*
    Remove files    ${templateFolder}/Files/Update/Main/Regular/*
    Remove files    ${templateFolder}/Files/Update/Main/Backfill/*
    Remove files    ${templateFolder}/Files/Prod/Main/Cobol/*
    Remove files    ${templateFolder}/Files/Prod/Main/C/*
    Remove files    ${templateFolder}/Files/Prod/Main/PLSQL/*
    Remove file    ${controlGenerateFolder}/${currentYear}/${currentMonthYear_controlGenerate}/file.txt
    Remove file    ${templateFolder}/Files/Update/Main/${updateTypePartialPath}/file.txt
    Remove file    ${templateFolder}/Files/Update/Control/C/file.txt
    Comment    Remove file    ${updateResultsFolder}/${currentYearFolder}/${currentMonthYear_updateGenerate}/Regression/Files/file.txt

*** Keywords ***
user is logged in
    Open Browser    http://rejkn02:8080/view/SUT%20Content%20Git    firefox

user saves the files
    Click Link    job/Gen_SUT_platform_content_master/
    Click Link    /view/SUT%20Content%20Git/job/Gen_SUT_platform_content_master/${buildNo_SUT_platform_content_master}/
    Click Link    artifact/dist/${currentYear}-${currentNoMonth}-sut-cobol-${buildTypePartialPath}-full.zip
    Wait For Active Window    Opening ${currentYear}-${currentNoMonth}-sut-cobol-${buildTypePartialPath}-full.zip
    Mouse Click    LEFT    1187    573    1
    Mouse Click    LEFT    1437    669    1
    Click Link    artifact/dist/${currentYear}-${currentNoMonth}-sut-c-${buildTypePartialPath}-full.zip
    Wait For Active Window    Opening ${currentYear}-${currentNoMonth}-sut-c-${buildTypePartialPath}-full.zip
    Mouse Click    LEFT    1187    573    1
    Mouse Click    LEFT    1437    669    1
    Click Link    artifact/dist/${currentYear}-${currentNoMonth}-sut-plsql-${buildTypePartialPath}-full.zip
    Wait For Active Window    Opening ${currentYear}-${currentNoMonth}-sut-plsql-${buildTypePartialPath}-full.zip
    Mouse Click    LEFT    1187    573    1
    Mouse Click    LEFT    1437    669    1

welcome page is open
    Page Should Contain    Jenkins

user returns to command prompt
    Close Browser
